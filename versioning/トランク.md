# トランクベースとブランチベース

トランクはメインブランチのこと。

メインブランチをバリバリ更新するなら、回帰テストの自動化ですぐに異常検知できるようにしないといけない。

ブランチベース

1. ローカルでブランチを切る（チェックアウト）
2. いくつかの変更をコミットする
3. テストして動作するのを確かめる
4. GitHub に上げる
5. プルリクを作ってレビューしてもらう
6. メインブランチにマージする（チェックイン）

トランクベース

1. ローカルでコードを書く
2. テストして動作するのを確かめる
3. メインブランチにコミットする
4. GitHub に上げる

メインブランチでも全てのコミットにバージョンをつけて正式版にするわけではない。
バージョンをつけたものだけがリリースされると考えられる。

トランクベース開発で、新しい機能を main に入れるけど、本番環境で OFF にできるようにする手法を feature flag という。
バージョン管理は便利になるけど、feature flag のバグには注意。
https://qiita.com/behiron/items/de1b082e60f7b4ade773

トランクベース開発でも feature ブランチを切って少し大きめの変更を作ることはある。
ただ、できるだけトランクに戻ってくるのを目指す。

メインブランチはいつでも本番サーバーに移行できるように運用する。
大きな変更はブランチを切る、本番で見せたくない部分は隠す、出来るだけ互換性を維持する、など。
