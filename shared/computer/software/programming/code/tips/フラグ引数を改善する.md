まずはフラグ変数を持っている関数の中身をselect文一つにまとめる。
部分部分で分岐させるのではなく、先頭だけで分岐される。
select一つにまとまったら、関数を分ける。

フラグ引数がどうしても必要になったら、もっと上の層がちゃんと分かれていない。
