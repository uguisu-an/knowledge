# ソフトウェア開発のルール

## 一般

見積もりの際、1 日あたりの作業時間は 6 時間の想定で見積もる。

開発サーバーに上げなくても、ローカルで動作確認できるようにする。

## テスト

E2E テスト以外はできるだけ自動化する。

## コメント、コミットログ

以下の格言に従うとよい。

-   コードには How（どうやって処理するか）を書く。
-   テストには What（何を処理するか、どういう機能か）を書く。
-   コメントには Why-not（なぜ理想の状態になってないか、なぜ妥協したか）を書く。
-   コミットログには Why（なぜ変更するか）を書く。

## ソースコードの管理

GitHub を使い、必ずソースコードを共有する。

案件によっては GitHub 以外のサービスを使うことがある。

## ソースコードの変更

互換性が失われる変更をできるだけ後回しにする。（互換性が失われる変更は新しい API を追加する。削除は deprecated にして、キリのいいところでまとめて廃止する）

コミットを小さくする。（main ブランチで作業する時間を増やす）

こまめに push する。（他の人が次の作業に入りやすくする）

必ず動作確認してから push する。

## メインブランチ（トランク）

メインブランチ以外のソースコードで本番サーバーを更新してはならない。

いつ本番サーバーに上げてもいいように、正常な動作を保つ。

開発中の実装は隠したり、feature ブランチを切ったりする。

## feature ブランチ

メインブランチが正常な動作を保てない（いくつかのコミットが必要な）場合、必要に応じて feature ブランチを切ってもよい。

メインブランチに統合する前に必ず動作確認する。

できるだけ早くメインブランチに統合する。

SHOULD | feature ブランチはできるだけ早く（正常に動作した時点で）main ブランチに統合する。

SHOULD | feature ブランチの名前には

意図がわかりやすい名前をつける。

個人名のプレフィックスを名前につけると重複しにくい。例えば、`ii/feature/xxx` のように。

## dev ブランチ

互換性を失う変更の時だけ、dev ブランチを切ってもよい。

次のメジャーバージョンに合わせて `v3` のようなブランチ名にする。

完成した後は必ずメジャーバージョンを増進する。例えば、`v2.5.3` → `v3.0.0` のように。

完成した後は必ずメインブランチに統合する。

## バージョンの変更

バージョンの命名規則は semver ([https://semver.org/lang/ja/](https://semver.org/lang/ja/)) に従う。

バージョンをファイルに記載する。 `package.json` や `composer.json` など。パッケージ管理ツールを使っていない場合は `VERSION` とする。

## 開発サーバーへの移行

開発サーバーを更新する前に、パッチ＝ビルドバージョンを増進する。例えば、`v2.5.3` → `v2.5.4` のように。

リリースに合わせて、マイナーバージョンを増進する。例えば、`v2.5.3` → `v2.6.0` のように。

開発サーバーを更新する前に、GitHub のブランチに統合する。（GitHub にないソースコードを使用してはならない）

関係者の許可を得ていれば、feature ブランチでも構わない。

## 本番サーバーへの移行

本番サーバーを更新する前に、開発サーバーで動作確認する。

本番サーバーを更新する前に、GitHub の「リリース」を追加する。

本番サーバーを更新する前に、GitHub のメインブランチに統合する。

## コーディング規約

PHP のコーディング規則は PSR に従う。

HTML/CSS/JS のコーディング規則は Prettier を導入する。

既存のプロジェクトは既存のコーディング規則に従う。
