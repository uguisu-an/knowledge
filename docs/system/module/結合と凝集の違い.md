# 結合と凝集

設計の基礎。

結合度を低めるためには「呼び出しの回数・引数を減らす」のが重要。

疎結合と高凝集は、良い「部品」の設計だ。

「高凝集」は、境界が明確で接点が少ない。

「部品」「モジュール」としての特徴が高凝集。
他の部品と組み合わせて使える。

密結合はいろんなところにコードが伸びている状態。実装に依存している。

設計では、同じ規格に沿った別の部品と交換できるようにする。

特別な理由がなければ、疎結合・高凝集を目指した方が無難。
つまり、機能を混在させず、依存もしないようにする。

モジュールの接点は少ない方がいい。

コードがあってもパッケージにしないと中身を読む手間がかかる。
中身はブラックボックスのまま使えた方が便利。

改善すべきは凝集度の低さであって、コードの重複ではない。
DRY 原則もコードの重複ではなく、概念の重複を避ける。

凝集度の定義は「モジュール内における、データとロジックの関係性の強さ」となっている。

実装が外に漏れていると、DI しようとなんだろうと密結合になってしまう。
DI はあくまでもコンポーネントに渡す委譲用のオブジェクトを最初に設定で変えられるようにするだけ。

凝集度は機能というよりもコンポーネントの関心や役割と言った方が一般的。

凝集度はモジュールの区切り方の良し悪しで、コンポーネントの役割を重視している。
結合度は区切られたモジュールの通信の良し悪しで、インタフェースの形式を重視している。

高さとか実装寄りの値を UI コンポーネントに渡さないといけないのは、そもそも実装が外に漏れている。
例えば、色を変更する場合なども active や variant を渡した方がいい。color を直接渡すよりも。
コンポーネントの挙動を変える時、コンポーネントでなく、それに渡しているパラメータの方を変えないといけなくなったら密結合だ。

低凝集の特徴として、同じようで少し違う機能が各所に散らかってる。

https://www.ogis-ri.co.jp/otc/hiroba/technical/Cohesion_Coupling/Cohesion_Coupling.html

まず、高凝集 > 疎結合の優先順位がある。
疎結合にすることよりも、高凝集にすることが優先。
