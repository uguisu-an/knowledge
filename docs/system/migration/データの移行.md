Excelなど、手作業で管理されていた元データには表記ブレもある。

データ間の紐付けに使えるのが氏名くらいしかない、ということもある。

紐付けなどができない場合は他のデータとも混ぜ合わせて、まず前処理しないといけない。

一旦生のデータを一つのデータベースに取り込んだ方が処理しやすい。

データ移行の時、idが頼りにならないと名前とかで照合しないといけない。表記ブレとか名称の変更が困る。
特にidを旧環境で持っていない場合、名前の変更は後回しにした方がいい。それも移行計画として考える。

1. データの移行計画
   1. サンプルデータの取得
   2. サンプルデータの分析
   3. 移行ポリシーの整理
   4. 移行先のデータベース設計
2. 移行準備
   1. 加工処理の準備
   2. マッピングデータの準備
      1. 表記ブレの補正
      2. 新旧表記の変換
      3. idやkeyへの変換
      4. など
   3. 詳細な移行手順の作成
   4. 移行ツールの作成
3. 生データの取得・収集
   1. 移行元の部署との調整
   2. 不足したデータの収集
4. 投入の準備
   1. 整形 (Excel => CSV, 資料 => CSV, など)
   2. 重複の削除
5. 生データの投入
6. そのままでは移行できないデータ（エラーリスト）の抽出・対処の検討・調整
7. 加工
   1. 値の調整・マッピング
   2. 不要なデータの絞り込み
8. 移行先テーブルへの移行

生データや加工の段階では、本来の移行先とは別にテーブルを用意した方がいい。
ワーキングテーブルやワークテーブルと呼ぶことがある。

そのまま移行できないデータは、できるだけマッピングして、どうにもならなかったら手作業や移行なしとなる。

エラーリストを出して、移行元の部署と調整が必要になったりすると、移行スケジュールに間に合わないので後日対応ということもある。

エラーリストやマッピングデータが多かったら、移行計画が甘かったということでもある。

ワーキングテーブルには一旦NULL許容でエラーになるものも全部入れて、目視や検索で確認する方法もある。
中間データも一旦ワーキングテーブルにINSERTしておくと経過がわかりやすい。

エラーリストも、SELECTで抽出するだけじゃなくて、データベースに入れたほうがいい。
SELECTは毎回確認しないといけないけど、まとめてINSERTを実行して後から確認できる。
登録の手順と確認の手順を分離する。

マッピング用のマスタデータは全件揃えないと抜け漏れや想定漏れが出てくる。
例えば、名前から社内IDを取ってくるマッピングで同姓同名がいるんだけど、マスタデータに漏れがあって検出できないとか。

データを移行したらアプリケーションで想定外の挙動をするなら、仕様の想定が足りてなかったと言える。
まぁ、いくらかは想定外の問題が起きるものだ。多すぎたら計画のやり方を見直したほうがいい。

データ移行で人間的なデータを集めると、名前くらいしかリレーションシップとして照合できないことがある。信頼できるメールアドレスがあったら神。名前しか照合できないと同姓同名が問題になる。

移行データが多い場合、一部のデータと業務だけを移して、できるだけ早く運用を始めた方がいい。段階的に移していく。

名前で紐付けてデータをマッピングするなら、中核になるテーブルだけは手作業で埋めたほうがよかったかも。業務の担当者とも連携して、こちらの推測で作った一覧を修正してもらう。

Excel管理から新たにシステム化するような案件では手作業でデータをまとめないといけないことも多い。

Excel管理されているような業務をシステム化するときは、名前くらいしか紐付けに使えるデータがないことも多い。
メールアドレスが信頼できると最高なんだけど、なかなかない。

データ移行時に除外する行のエラーリストは、原因別に分かれるように細かく分けた方が後から対処しやすい。

データ移行では、特定の条件に一致する行、あるいは特定のidを持った行を除外できるようにしたほうがいい。
データベース管理されていなかったデータを移行する場合は特に例外が多いので、機械的に流し込めないデータもある。

データ移行は人力でデータを調べたり、パッチを当てたりしないといけない部分も出てくる。たくさん出てくる。
