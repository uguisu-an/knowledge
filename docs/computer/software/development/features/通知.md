# 通知 Notification

iOS や Android、Web Push はそれぞれ独自に実装しないといけない。
Firebase Cloud Messaging や AWS SNS などの通知サービスを使うのが簡単。

ロングポーリングの場合、サーバー側は保留中の接続を多く持っても平気な構成にしないといけない。Ruby や PHP のサーバーは接続ごとにプロセスを作って負荷が高くなりがち。

サーバーの更新通知の選択肢

ショートポーリング（定期的にリクエストする）
ロングポーリング（リクエストに対するレスポンスを保留して、レスポンスが返ってきたらリクエストし直す）
SSE（接続しっぱなしでストリームを返す）
WS（双方向通信）

ロングポーリングは更新の頻度が低いとよく機能する。
ただ、ロングポーリングや SSE は保留中の接続を扱いやすい Node のような基盤でないと接続が多い場合に耐えられない。
PHP や Ruby なら間隔長めのショートポーリングで妥協するのもありかも。

通知のパターン
https://progzakki.sanachan.com/technology/server-push-technology/

今のところ、ロングポーリングか SSE でいい気はする。WS はやりすぎ。LINE は MQTT を使ってるみたい。

通知を切るために退会する人がいるので、通知は設定で切れるようにしないと離客率を上げてしまう。
