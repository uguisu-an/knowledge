データベースに接続してテストする。
機能テストやシステムテストに含まれる。

重くなりがちなので、データベースアクセス自体はRepositoryやQueryServiceのようなコンポーネントにまとめて、あとはモックやダミーでユニットテストにした方がいい。
そもそもRepositoryやQueryServiceのテストも頻繁に変更される部分ではないので、一度通したらあとはCI/CDの時に回すくらいでいい。

データベーステスト特有の作業:

- データベースのリセット（Sequenceなど）
- テーブルのリセット
- データの投入（テストデータやマスタデータなど）
- データの検証

データベーステストを補助するツールとして、例えばJavaならDbUnitのようなユーティリティがある。

testcontainersのようなツールを使うと、コンテナとしてデータベースを作ってコードから制御することもできる。
https://testcontainers.com/

https://qiita.com/Syuparn/items/7fabaeadbfcd2532fd62

モックでデータベースを置き換えるだけでは、データベースに接続するところまでテストできたとは言えない。
あくまでもモックはデータベースアクセスするコンポーネントを置き換えて、他の部分をテストするためのもの。

データベースに接続するテストの仕組みを整備して、運用して、反省したこと #CI - Qiita
https://qiita.com/gengen0719/items/d42a7f60e9a0ebc6f345
