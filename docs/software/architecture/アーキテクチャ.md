# Software Architecture

Store は Model というよりも、Controller の層でサーバー側の情報をキャッシュする部分。Gateway に近い。

- 『ソフトウェアアーキテクチャの基礎』Mark Richards, Neal Ford

代表的な要素は、

- 構造
- 非機能特性
- 依存関係
- インタフェース
- 構造手法

システム構築中に行われる他多数の設計判断とは異なり、システムの性能・品質・拡張性に、長期的かつ永続的に影響を与えるものが重要。

https://www.infiniteloop.co.jp/tech-blog/2023/03/what-is-adr/

デザインは外に向いてるけど、アーキテクチャは内に向いている。
アーキテクチャは骨組み。システムを支えるもの。

アーキテクチャはデザインの基盤になるので、アーキテクチャを変えるほうが難しい。

デザインはアーキテクチャに依存する。

デザインで重要なのは対象を「どう扱うか」という部分。おもちゃの場合はあえて扱いづらい制約を載せることもある。

アーキテクチャはシステムのためにある。ユーザ向けのデザインと比べると内向きであると言える。

例えば、木工デザインのおけるアーキテクチャは木や金具。それによってデザインが制限される。いや、アーキテクチャから無理に外れるなら、そもそもそのアーキテクチャを選択する意味がない、というべきか。

アーキテクチャに囚われずにデザインしたうえで、アーキテクチャに載せることも考えられないとデザイナーとは言えない。

- MVC
- MVVM
- レイヤードアーキテクチャ
- オニオンアーキテクチャ
- クリーンアーキテクチャ

クリーンアーキテクチャはどこで「分けられるか」の話で、実装上で「分けないといけない」わけではない。

アーキテクチャのコツは依存を一方的にすること。
常に、外から内へ、具象から抽象へ依存する。

アーキテクチャは設計の中でも実装寄り。
コンピュータでシステムを構築するためのもの。システムやアプリケーションなど、構築したいものによってアーキテクチャは異なる。
もっと一般化して「崩れないように組み立てる」ためのもの、とするといいかも。

ドメインロジックの再設計でアプリケーション層が影響を受ける。
実務上はアプリケーション層にも気を使って、deprecatedでしばらくインタフェースを残したり、下手に変えないようにしたりすると親切。

ドメインロジックへの依存も含めて、ドメインやアダプタを統合するのはアプリケーション層の役割。ドメインから他のドメインや汎用ドメインに依存するべきではない。一つのドメインはそのドメインの中で完結させる。教会づけられたコンテキストに沿って独立させる。

ドメインロジックは自身以外の仕様や設計が変更されても影響を受けるべきではない。一番下の層。全ての基礎。全てはドメインロジックに依存するべきで、ドメインロジックから何かに依存するべきではない。

アプリケーション層やアダプタ以外の部分が周りの変更の影響を大きく受けるようなら設計が間違っている。統合はアプリケーション層に任せて、外部インタフェースの変更はアダプタで吸収する。

変更が多い部分というより、影響を受けやすい部分にテストを書いて、影響を受けてないか検証するのが大事。まぁ、そもそもそんなに影響を受けるのはアプリケーション層みたいに統合する部分だけのはずで、ドメインロジックなんかは仕様変更以外の影響を受けるべきではない。ライブラリなんかも利用しない方がいい。

MVCとかMVVMとかはそもそもアプリケーション層が中心のアーキテクチャ。CやVMで統合している。
