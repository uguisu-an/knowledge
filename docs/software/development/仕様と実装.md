# 仕様と実装

仕様は、実装の「完了」の定義。

仕様が同じでも、実装を同じにする必要はない。

実装は仕様を満たさないといけない。

実装を知らないと使えないのは設計として失敗している。

実装ではなく、仕様に依存する。

テストが終わるまで「実装した」とは言えない。

テストされてないコードは実装されてないコードだ。

テストコードは実装を支援する。
先にテストを書けば、仕様を満たすまで失敗してくれる。

動作確認してない実装は完成してない。

実装して動作確認して、検証できる状態を標準的な「完成」とする。

実装してもまだ検証されてない。

実装は検証のための手段。

以下の順で作る。

1. 動くもの
2. 長く動くもの（メンテナンスしやすいもの）
3. 速く動くもの

受け入れ条件は「やること」に対して考えるので、「やらないこと」は出てこない。

仕様を詳しくしていく手順：

1. ユーザーストーリー
2. 受け入れ条件（フィーチャー＊シナリオ）
3. 受け入れテスト
4. 自動化された受け入れテスト

受け入れテストは実装の間に済ませる。
そもそも受け入れテストしていないものを「実装した」とは言わない。

テストも、実装ではなく、仕様に依存させる。

実装の都合でインタフェースを変えるべきではない。

部品を定義して、製品からは部品との境界だけを考えると複雑さを抑えられる。

仕様書には要求仕様だけを書かなければならない。
実装仕様に追従してしまうと、バグ（要求仕様と実装仕様の差分）かどうか判らなくなる。

定義されていない動作を例外として明示的に実装する。

例外を投げるのは、定義されていない動作を明示的に失敗させるため。

要求仕様と実装仕様

「要求仕様」は、受け入れテストによって定義できる。
「実装仕様」は、受け入れテストによって検証できる。

仕様が変われば、実装も変わる。

実装できない仕様は机上の空論だ。
SF は夢だが、すぐには実現できない。

実装仕様は、要求仕様を使った検査によって明らかになる。
ここで初めてバグが認識される。

「完成」の概念と関わりがある。
完成品の定義と完成品そのもの。要求仕様と実装仕様。

仕様と実装が一致しなければ、バグになる。
不具合やエラーとは別。

仕様と実装が一致しているかどうかは、検査されなければならない。
検査されるまで実装が終わったとは言えない。

新しい仕様を見つけるレビュー、新しい実装を見つけるリファクタリング、とも関わりがある。

より優れた実装方法の発見によって、より優れた仕様を採用できることがある。

製品を拡張していくと、仕様と検査項目は増えていく。全てにパスしないといけない。

実装しても価値があるとは限らない。
あくまでも完成しただけで、価値があるかどうか検証されなければならない。

完成しないと検証できない。

実装は、検証の手段でしかない。

実装のコストは高いが、ハードウェアよりはソフトウェアの方が低い。

仕様と実装における「テスト」は、仕様と実装が一致するのを確認するもの。
仕様とテストは一致していて、実装よりも前に決まっている。

対して、品質分野にも「テスト」がある。
こちらは新しい要求を見つけるためのもの。「レビュー」に近い。

素早く検証のイテレーションを回すためには、完成を近づけないといけない。
つまり、実装すべき仕様を削ったり、仮の実装＝モックで簡単な検証を先にやってみたり、実装に関わる作業を機械化したり。

モックは、少なくともデモ＝最小限のテストの範囲で仕様を満たす仮の実装。

仕様と実装が一致している限り、外から見ると、実装は隠れている。

仕様と実装は「製品」の言葉。
実装前の仕様はユーザーストーリーは「こういう製品を作ったら喜ぶだろう」という仮説だ。製品を実装して、検証したら証明できる。

実装作業はテストまで含むので、特定の設計でテストが面倒になるなら実装が簡単になるとは言わない。

機能や性能は仕様の一部。
「メモリ 4 GB」とか「プロセスを同時に 1000 件実行できる」とか「タスクスケジュール A は 1〜4 時の間に完了する」とかも。
同じ仕様を表していても、書き方はいろいろある。
「タスク B は 1 秒に 4 件までしか実行できない」といった制限も仕様になる。

仕様は「製品がどうなるか」あるいは「製品がどうなっているか」を表す。
実装は「どうやって動いているか」の部分。

仕様が矛盾していると実装できないことがある。
例えば、「1 分間に 180 件までしか実行できない」のに「1 分間に 300 件処理する」となっていたら矛盾している。

要件は「契約」の言葉で、仕様は「製品」の言葉だけど、完了条件を示すという意味では同じ。

「仕様」は、ある時点でどのような製品になっているか。
「実装」は、製品がどうやって機能しているか。

仕様には規格としてのインタフェースも含まれるけど、それだけではない。
どちらかというと受け入れ条件としてのさまざまな制約条件を表す。

どんな開発方法でも、仕様は実装の前に考えないといけない。
完成を定義しないと完成しない。

実装を仕様に近づけていくと「完成」に近づく。
仕様を実装から遠ざけていくと「完成」も遠ざかる。

要求が変わると理想の仕様も変わる。
現行の仕様を理想の仕様に近づけていくのが品質向上。
完成を目指す活動と品質向上を目指す活動は明確に区別しないといけない。

要求に対して、仕様はどこかで固定しないと実装を進めづらい。
要求の収集 → 次の仕様の確定 → 実装 → 収集に戻る、の繰り返し。

仕様がゴミなら、実装してもゴミになる。

リファクタリングで実装を整理する前に、できれば仕様を整理する。余計な仕様と実装を削除する。

「仕様と実装」も正確には「実装されるべき仕様と実装された仕様」というべきか。

品質は仕様によって決まる。
実装は仕様に従っていること。

仕様を考えるためには、実装を知らなければならない。
実際に作業として実装するかどうかはともかく、実装の知識は必要。
例えば、油絵の具に触ったことのない素人には油絵の監修もできるわけがない。

根本的に実装エアプ勢は舐められるのでそもそも指示しても従ってもらえない。

設計の段階から製造・実装しやすさを考えないと無駄なコストがかかる。
設計はあくまでも実装の過程。

仕様や実装は製品の話だけど、機能や要求は顧客の話。

顧客によって製品の想定された機能とは違う機能を見出すこともある。
例えば、包丁で人を殺してしまう人がいるように。

手順が含まれるなら仕様というより実装。
仕様の場合は手順というよりも条件が表に出てくる。

実装：
A をして、B をして、C をする。

仕様：
A かつ B のとき、C になる。

象の耳は、
「熱を放出する」のが仕様、
「表面積を大きくする」のが実装。
でも他の実装でも仕様が満たせたらそれでいい。
まぁ、効率とかはあるけど。効率を決めるのは実装。

実装がたまたま別の仕様を生じることがある。

仕様は「こうなっている」というだけなので、役に立たない特徴も仕様としてありうる。
仕様の中で役に立つものが「機能」として扱われる。

効果は仕様、効率は実装で決まる。
ただし、実装は仕様を満たすものとする。

仕様を残さないと、実装が間違っているかどうかわからない。
仕様と実装の差がバグなので。

実装は「表現」と同じ。
製品を体験できる状態にすること、あるいは体験できる状態になったもの。

ビルドやテストは実装の範囲内。
ビルドしてテストしないと実装できたかどうか確かめられない。

仕様を把握してないのに実装しても実装したつもりになるだけ。
