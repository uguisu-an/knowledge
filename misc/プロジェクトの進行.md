# 要件定義

「要件」とは、要求に作業範囲をつけたものだ。

作業範囲の課題が全て着手可能になっていなければ、要件定義が終わったとは言えない。

要件を決めるのは先延ばしにしない。
仮にでもとにかく決めて、それから変更を管理する。変更には費用が伴う。

要件定義のために顧客と交渉するのは手段。

準備中
↓ P 計画
着手可能
↓ P 着手
進行中
↓ C 検査
完了
↓ A 検証
新しい課題

開発チームは、要件定義の段階から必要。
開発チームのレビューを通さないと課題は「着手可能」にならないし、「着手可能」にならないと要件定義は終わらない。

課題管理表を作るだけではなく、次の範囲を着手できるようにせねばならない。

課題管理表を作るだけでは、着手可能にならない。

受け入れ条件も細かいところは作りながらでもいいけど、何を作って、何を作らないかは明記しないといけない。

提案や要望でやりたいことを集めて、
具体的なシステムの機能として落とし込んで、
その中から開発範囲を決めて、
合意する。ここまでが要件定義。

案件の完了を定義するのが要件定義だ。

ユーザーと話すのは処理の流れというよりも代替する業務の流れだ。

要件定義では、顧客から見た振る舞いを合意する。
それ以外の部分は実装でうまいことやればいい。

目視確認の工程は自動化の足手まといだし、省略するなら実装しなくていい。

「XXX と同じ」のような要件は、「XXX」の詳細が変わると要件も変わってしまう。
それでは完成を定義したことにならないので、「XXX とは同じ」とは何かを明確に要件として定義する。

一人で要件定義すると、漏れが多くなる。

期日に遅れないように、初めから内容に余裕を持たせる。
そもそも試験期間を 1/3 取っていれば、そこまでに終わるように内容を決めればいい。

ディレクターの一番の仕事は「完了を定義する」こと。
できれば完成品が儲かるものであればいい。

要件定義の進め方:

1. スケジュールを決める
2. システム構成を決める
3. イシューを集める
4. ストーリーの形式に整理する（具体化）
5. 規模の大まかな見積もりをつける
6. 大きすぎたら分割する
7. 優先順位をつける
8. 受け入れ条件を決める（完了の定義）
9. 規模の詳しい見積もりをつける
10. あらためて優先順位をつける
11. 期間内で目標にする範囲を決める

要件定義の進め方:

1. イシューを集める
2. ストーリー形式に整理する
3. 受け入れ条件を決める
4. 期限を決める

ストーリーの詳細を考える

- どうしたら着手できるか
- どうしたら完了できるか
- どれくらいで完了できるか
- 依存している他の課題と合わせられないか
- 小さく分けられないか
- 価値があるか
- 誰にとって価値があるか
- どのように操作するか
- どのように実装するか

開発の流れ

1. 要求を洗い出す。
2. それぞれの要求がお互い依存しないように分ける。
3. 優先順位をつける。
4. 大中小で大まかな規模を見積もる。
5. 大きすぎる要求を小さく分けて、(4)に戻る。
6. ユースケースやドメインモデルを話し合う。
7. 受け入れ条件を決める。
8. （プロジェクトの範囲を合意する）
9. 実装する。
10. 要求が満たされたか検証する。

「受け入れ条件」とは「どういう状況で」「どういう操作をすると」「どういう結果になるか」である。

要件定義で予算に合わせて要件を詰められないと、曖昧な要求のまま契約するのは厳しい。

ディレクターは要件定義の期間に受け入れ条件を先方と話して詰める必要がある。
その通りの内容で検収して、OK なら他に要望があっても納品できるようにする。

要件定義・概要設計では期待する動作まで詰めないと認識がずれやすい。

概要設計：

1. 機能の洗い出し
2. 辞書の作成
3. ストーリーとして整理
4. ざっくり見積もり（大中小）
5. 機能の絞り込み
6. 詳しい見積もり（ストーリーポイントか理想日）
7. 受け入れテストの定義（範囲の半分以上）

外部設計：

- DB 設計
- UI 設計（入出力とワイヤーフレーム）
- API 設計

要件定義の間に技術検証も済ませておきたい。

概要設計：

1. 将来的なものも含めて、機能や仕様を相談する。
2. 登場する要素の辞書を作る。
3. 各機能をユーザーストーリーとして整理する。
4. 各機能の開発規模を見積もる。
5. 予算や納期に合わせて、開発範囲を相談する。
6. 大きすぎる機能は分割する。
7. 詳細な仕様を相談する。
8. 各機能の正常系の仕様をテストとして整理する。
9. 各機能の異常系の仕様をテストとして整理する。

キックオフでやっておきたいこと：

- 関係者の確認
- 開発体制・役割分担の確認
- 挨拶
- プロジェクトの背景や前提の共有
- スケジュールの共有
- システム構成の確認
- やること、やらないことをざっくり確認

要件定義（プランニング）→ 開発 → 検収（デモ）の流れはスクラムでも同じ。回数が多いだけ。

要件レビューの段階で機能の見積もりも終えて、大きすぎるものは分割されている。

試験期間は試験というよりも作り込みの期間と考えられる。

スケジュールは「遅れない」ためではなく、「遅れたことに気づく」ためにある。

以下の 3 つがプロジェクト管理の三種の神器。

- WBS（課題管理表＆予定表）
- 体制表
- システム構成図

- 要件定義（概要設計・外部設計）
- 開発（詳細設計・内部設計・実装・ビルド・試験の自動化）
- 配信（サーバー構築・デプロイ・納品）

ファイル構成

- システム構成図
- 体制表
- 予定表
- 辞書・用語集
- 課題管理表
- 会議資料/
  - xxxx-xx-xx/
    - アジェンダ
    - その他の説明資料
- 議事録・録画リンク集/

概要設計ではアプリケーションを、外部設計ではアダプタを考える。

試験と調整の期間を短くしてもいいのは、要件定義できっちりと認識を合わせられて、その認識がずれるまでに実装を終えられる場合に限る。

認識がずれるかどうかは相手次第なので、試験と調整の期間を短くするとほとんどが運任せになる。

お客さんが納得せずにトラブルになるようなら、試験・調整期間を長めに取る必要がある。

あまりにも細かい合意は信頼を欠いている。

お客さんに見せるのが遅ければ遅いほど、トラブルになる。

レビューするための最終成果物とは別に、最終成果物を作る過程で中間成果物が出る。
説明資料とか、設計資料とか。

スケジュールやバックログで遅れを検知する一方で、そもそも遅れないように進める必要もある。

まず、要求には「規模」がある。→ どれくらい大きいか。
次に、他の業務との兼ね合いも含めて「期間」が決まる。→ いつ頃終わるか。
また、それとは別に余裕を持った「期限」がある。→ いつ頃までに終わらせるか。

1. 開発範囲を決める
2. 開発範囲を共有する
3. 各自が検討する時間を確保する
4. 全員で集まって詳細を詰める
5. 資料にまとめる

要件定義に全体の 1/5、残りのうち 1/3 を試験・調整、2/3 を開発に当てるのが基本構成で考えてる。
60h であれば、要件定義に 12h、開発に 32h、調整に 16h となる。

1. 各自の持っている情報を交換する
2. それぞれ提案内容を考える
3. 持ち寄ったものから一つ選ぶ
4. 別の案の良いところも取り込んで仕上げ

マイルストーン

1. 発注（要件定義フェイズの終了）
2. 着手（開発フェイズの開始）
3. 仕様の凍結（試験フェイズの開始）
4. 納品（リリース）

開発の流れ

1. 着手（契約締結）

- コア機能の開発

2. alpha 版

- その他の機能の開発
- 定期レビュー
- 新たな要望の取り込み

3. beta 版

- 試験
- 検収
- 細かい調整
- バグフィックス

4. 完了（納品）

最低限、この 4 つはスケジュールとして決めた方がいいと思う。
それぞれの完了条件はプロジェクトごとに調整することがある。

先方に検収を任せると遅いので、alpha 版の時点で何度かデモしてその場で要望をもらう。
機能が揃ったら最後に beta 版を出して、試験と検収。
ここはもうデモしないでそのままバグフィックスして納品する。

要求（問題領域の分析）

1. ユーザーストーリー
2. システムにするユーザーストーリー（スコープ）
3. ドメインを理解する（ドメインモデルのドラフト。要素と関連だけで問題領域を理解する）
4. システムにする場合の全体像（紙芝居）
5. ユースケースのドラフト（ユーザーとシステムの間の対話を定義する）
6. レビュー

予備設計

1. ロバストネス分析（画面、処理、記録の構成）
2. ドメインモデルの改善（要素を詳細に、属性の検討）
3. ユースケースを呼び出すコントローラーを分析（API、UI からの呼び出し方にあたる）
4. ユースケースの整理
5. レビュー

詳細設計

1. ユースケースごとにシーケンスを分析（ドメインオブジェクトのメッセージングを定義）
2. ドメインモデルの改善（シーケンスの分析をもとにメソッドやサービスを作成）
3. ドメインモデルの整理（この時点でほとんどクラス図になる）
4. レビュー

実装

1. コーディングとテスト

フェイズを分ける場合は 3〜6 ヶ月あたりを上限にしないと大きすぎて分けた意味がない。

[完璧な要件定義など幻想である。個ではなく、チームで作る要件定義](https://qiita.com/Haruyuki_Hirose/items/2ce5a2877bc5c66aa2b3)

人員を増やしても、品質を下げても、むしろ遅れる。
人員を増やせばオンボーディングに、品質を下げればテストに、時間がかかる。

要件定義も遅れてはならない。
要件定義で決まらなくても仮で決めて、納品後に別途発注させる。
あるいは、要件定義を伸ばした分だけ、作業量を減らす。
最終的な納期が延びないようにする。

PM としてはバージョンというよりもマイルストーン・期限と考える。
