# Test Coverage

網羅率。

C0/C1/C2のレベルがある。

[テストカバレッジ100%を実践した結果、100%を目指さない方がいいと理解した](https://zenn.dev/ikemo/articles/test-coverage-100-percent)

ホワイトボックステストは基本的に無駄だけど、100%を目指すとホワイトボックステストでしか通らない部分までテストを書くことになる。
カバレッジを増やすよりもE2Eテストとかもっと高レイヤーのテストやデバッグに時間をかけたほうがいい場合もある。

カバレッジはあくまでも単体テストのレベル。
カバレッジを100%にする以上に、他のレイヤーのテストも必要。

カバレッジの基準
https://forza.cocolog-nifty.com/blog/2021/07/post-5dff27.html

> ・Googleでは、60％を「許容可能」、75％を「推奨」、90％を「例示的」という一般的なガイドラインを提供しています。
> ・90％のコードカバレッジから95％に到達する方法に執着するべきではありません。
> ・プロジェクト全体で90％を超える目標は価値がない可能性が高いですが、コミットごとのカバレッジ目標である99％は妥当であり、90％は適切な下限しきい値です。

カバレッジの測定方法はC0, C1, C2とあるが、C2はやりすぎ。意味がない。
Go組み込みのテストツールはC0しか取れない。

C0しか取れないテストツールの場合、明示的にelseやdefaultを書いてあげるとC1に近づけられる。

次のようなコードはelseがないのでC0しか取れないツールではC1よりも簡単にカバレッジが高くなってしまう。
また、実装としてもelseがないのは大体この関数の中で判定する必要がないか、実装もれを疑われる場合が多いのでレビューで落としたほうがいい。あるいは明示的に例外にする。

```js
function doSomething(xxx) {
  if (xxx) {
    // do something
  }
}
```

https://medium.com/veltra-engineering/what-is-the-coverage-of-golang-standard-b2bffdd0596

> カバレッジはあくまでも実装したコードがテストで実行されたかどうかの確認にすぎないため、そもそも機能の実装漏れがあった場合、カバレッジだけでは検出できません。

コミットの際にカバレッジが下がらないようにする。カバレッジは100%を目指さずに、維持する。

カバレッジを100%にしても仕様の漏れを全て拾うことはできない。
